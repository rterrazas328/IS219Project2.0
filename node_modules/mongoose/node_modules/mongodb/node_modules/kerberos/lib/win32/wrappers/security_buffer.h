#ifndef SECURITY_BUFFER_H
#define SECURITY_BUFFER_H

#include <node.h>
#include <node_object_wrap.h>
#include <v8.h>

#define SECURITY_WIN32 1

#include <winsock2.h>
#include <windows.h>
#include <sspi.h>
<<<<<<< HEAD
#include <nan.h>
=======
#include "nan.h"
>>>>>>> 923637243c51b35e8862bfced9d2f31719759a83

using namespace v8;
using namespace node;

<<<<<<< HEAD
class SecurityBuffer : public Nan::ObjectWrap {
  public:
    SecurityBuffer(uint32_t security_type, size_t size);
    SecurityBuffer(uint32_t security_type, size_t size, void *data);
    ~SecurityBuffer();
=======
class SecurityBuffer : public ObjectWrap {  
  public:    
    SecurityBuffer(uint32_t security_type, size_t size);
    SecurityBuffer(uint32_t security_type, size_t size, void *data);
    ~SecurityBuffer();    
>>>>>>> 923637243c51b35e8862bfced9d2f31719759a83

    // Internal values
    void *data;
    size_t size;
    uint32_t security_type;
    SecBuffer sec_buffer;

    // Has instance check
<<<<<<< HEAD
    static inline bool HasInstance(Local<Value> val) {
      if (!val->IsObject()) return false;
      Local<Object> obj = val->ToObject();
      return Nan::New(constructor_template)->HasInstance(obj);
    };

    // Functions available from V8
    static void Initialize(Nan::ADDON_REGISTER_FUNCTION_ARGS_TYPE target);
    static NAN_METHOD(ToBuffer);

    // Constructor used for creating new Long objects from C++
    static Nan::Persistent<FunctionTemplate> constructor_template;

=======
    static inline bool HasInstance(Handle<Value> val) {
      if (!val->IsObject()) return false;
      Local<Object> obj = val->ToObject();
      return NanNew(constructor_template)->HasInstance(obj);
    };

    // Functions available from V8
    static void Initialize(Handle<Object> target);    
    static NAN_METHOD(ToBuffer);

    // Constructor used for creating new Long objects from C++
    static Persistent<FunctionTemplate> constructor_template;
    
>>>>>>> 923637243c51b35e8862bfced9d2f31719759a83
  private:
    static NAN_METHOD(New);
};

#endif